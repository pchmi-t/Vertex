<!DOCTYPE html>
<!--[if IE 9 ]><html class="ie9"><![endif]-->
<head>

<title>Vertex Dashboard</title>

<!-- CSS -->
<link href="/vertex/resources/css/bootstrap.min.css" rel="stylesheet">
<link href="/vertex/resources/css/animate.min.css" rel="stylesheet">
<link href="/vertex/resources/css/font-awesome.min.css" rel="stylesheet">
<link href="/vertex/resources/css/form.css" rel="stylesheet">
<link href="/vertex/resources/css/calendar.css" rel="stylesheet">
<link href="/vertex/resources/css/style.css" rel="stylesheet">
<link href="/vertex/resources/css/icons.css" rel="stylesheet">
<link href="/vertex/resources/css/generics.css" rel="stylesheet">
</head>
<body id="skin-blur-blue">

	<header id="header" class="media">
		<a href="" id="menu-toggle"></a> <a class="logo pull-left"
			href="/vertex/index.html">Vertex Dashboard</a>

		<div class="media-body">
			<div class="media" id="top-menu">
				<div id="time" class="pull-right">
					<span id="hours"></span> : <span id="min"></span> : <span id="sec"></span>
				</div>
			</div>
		</div>
	</header>

	<div class="clearfix"></div>

	<section id="main" class="p-relative" role="main">

		<!-- Sidebar -->
		<aside id="sidebar">

			<!-- Sidbar Widgets -->
			<div class="side-widgets overflow">
				<!-- Profile Menu -->
				<div class="text-center s-widget m-b-25 dropdown" id="profile-menu">
					<a href="" data-toggle="dropdown"> <img
						class="profile-pic animated"
						src="/vertex/resources/img/profile-pics/male-user-icon.jpg" alt="">
					</a>
					<ul class="dropdown-menu profile-menu">
						<a href="/vertex/tasks.html">My Tasks</a> <i class="icon left">&#61903;</i><i
							class="icon right">&#61815;</i></li>
						<li><a id="signout" href="/vertex/logout">Sign Out</a> <i class="icon left">&#61903;</i><i
							class="icon right">&#61815;</i></li>
					</ul>
					<h4 id="userFullName" class="m-0"></h4>
				</div>

				<!-- Calendar -->
				<div class="s-widget m-b-25">
					<div id="sidebar-calendar"></div>
				</div>

				<!-- Feeds -->
				<div class="s-widget m-b-25">
					<h2 class="tile-title">Recent Activities</h2>

					<div class="s-widget-body">
						<div id="eventssection" class="media p-l-5"></div>
						<div class="media p-l-5">
							<div id="noeventsmessage" hidden=true class="text-center">
								<a class="t-overflow" href="">You are not subscribed for any
									events yet.</a>
							</div>
						</div>
					</div>
				</div>
			</div>

			<!-- Side Menu -->
			<ul class="list-unstyled side-menu">
				<li class="active"><a class="sa-side-home" href="index.html">
						<span class="menu-item">Dashboard</span>
				</a></li>
			</ul>

		</aside>

		<!-- Content -->
		<section id="content" class="container">


			<section id="main" class="p-relative" role="main">
				<div class="block-area" id="horizontal">
                    <h3 class="block-title">Create Task</h3>
                    <form class="form-horizontal" role="form">
                        <div class="form-group">
                        	<label for="tasktitle" class="col-md-2 control-label">Title</label>
                            <div class="col-md-10">
                                <input type="text" class="form-control input-sm" id="tasktitle" placeholder="Task Title">
                            </div>
                        </div><br/>
						<div class="form-group">
                        	<label for="priority" class="col-md-2 control-label">Priority</label>
                            <div class="col-md-10">
                               <select id="priority" class="select">
									<option>Minor</option>
									<option>Major</option>
									<option>Critical</option>
									<option>Blocker</option>
								</select><br/><br/>
                            </div>
                        </div>
                        <div class="form-group">
                        	<label for="priority" class="col-md-2 control-label">Deadline</label>
                        	<div class="col-md-10 input-icon datetime-pick date-only">
								<input id="deadline" data-format="dd/MM/yyyy" type="text"
									class="form-control input-sm" /> <span class="add-on">
									<i class="sa-plus"></i>
								</span>
							</div>
                        </div>
						<br />
						<div class="form-group">
                            <label for="taskdef" class="col-md-2 control-label">Definition</label>
                            <div class="col-md-10">
                                <textarea class="form-control auto-size input-sm" id="taskdef"></textarea>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="col-md-offset-2 col-md-10">
                                <button id="createtaskbtn" type="submit" class="btn btn-info btn-sm m-t-10">Submit</button>
                            </div>
                        </div>
                    </form>
				</div>
				<div class="clearfix"></div>
			</section>
		</section>
	</section>

	<script src="/vertex/resources/js/jquery.min.js"></script>
	<script src="/vertex/resources/js/jquery-ui.min.js"></script>
	<script src="/vertex/resources/js/jquery.easing.1.3.js"></script>
	<script src="/vertex/resources/js/bootstrap.min.js"></script>
	<script src="/vertex/resources/js/charts/jquery.flot.js"></script>
	<script src="/vertex/resources/js/charts/jquery.flot.time.js"></script>
	<script src="/vertex/resources/js/charts/jquery.flot.animator.min.js"></script>
	<script src="/vertex/resources/js/charts/jquery.flot.resize.min.js"></script>
	<script src="/vertex/resources/js/autosize.min.js"></script> <!-- Textare autosize -->

	<!--  Form Related -->
	<script src="/vertex/resources/js/validation/validate.min.js"></script>
	<script src="/vertex/resources/js/validation/validationEngine.min.js"></script>
	<script src="/vertex/resources/js/chosen.min.js"></script>
	<script src="/vertex/resources/js/datetimepicker.min.js"></script>
	<script src="/vertex/resources/js/icheck.js"></script>
	<script src="/vertex/resources/js/toggler.min.js"></script>
	<script src="/vertex/resources/js/input-mask.min.js"></script>
	<script src="/vertex/resources/js/spinner.min.js"></script>
	<script src="/vertex/resources/js/slider.min.js"></script>
	<script src="/vertex/resources/js/fileupload.min.js"></script>

	<script src="/vertex/resources/js/sparkline.min.js"></script>
	<script src="/vertex/resources/js/easypiechart.js"></script>
	<script src="/vertex/resources/js/charts.js"></script>
	<script src="/vertex/resources/js/select.min.js"></script>
	<script src="/vertex/resources/js/maps/jvectormap.min.js"></script>
	<!-- jVectorMap main library -->
	<script src="/vertex/resources/js/maps/usa.js"></script>
	<!-- USA Map for jVectorMap -->

	<!--  Form Related -->
	<script src="/vertex/resources/js/icheck.js"></script>
	<!-- Custom Checkbox + Radio -->

	<!-- UX -->
	<script src="/vertex/resources/js/scroll.min.js"></script>
	<script src="/vertex/resources/js/calendar.min.js"></script>
	<script src="/vertex/resources/js/feeds.min.js"></script>
	<script src="/vertex/resources/js/markdown.min.js"></script>
	<script src="/vertex/resources/js/functions.js"></script>
	<script src="/vertex/resources/js/template.js"></script>

	<script>
		$(window).load(function() {
			getUser();
			getEvents();

			$("#createtaskbtn").on('click', function(event) {
				event.preventDefault();
				
				var deadlineStr = $("#deadline").val().split('/');
				var deadlineDate = new Date(deadlineStr[2], deadlineStr[1]-1, deadlineStr[0]); 

				var task = {
					priority : $("#priority option:selected").val().toUpperCase(),
					title : $("#tasktitle").val(),
					definition : $("#taskdef").val(),
					deadline: deadlineDate
				}

				$.ajax({
					url : "/vertex/api/task/project/" + getParameterByName('projectId'),
					type : "POST",
					data : JSON.stringify(eval(task)),
					contentType: "application/json",
					success : function() {
						location.reload();
					},
					error : function(jqXHR) {
						alert("Unfortunately, this task could not be created.")
					}
				});
			});
		});
		
		function getParameterByName(name, url) {
		    if (!url) url = window.location.href;
		    name = name.replace(/[\[\]]/g, "\\$&");
		    var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
		        results = regex.exec(url);
		    if (!results) return null;
		    if (!results[2]) return '';
		    return decodeURIComponent(results[2].replace(/\+/g, " "));
		}
	</script>
</body>
</html>
