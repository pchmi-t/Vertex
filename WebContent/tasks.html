<!DOCTYPE html>
<!--[if IE 9 ]><html class="ie9"><![endif]-->
<head>

<title>Tasks</title>

<!-- CSS -->
<link href="/vertex/resources/css/bootstrap.min.css" rel="stylesheet">
<link href="/vertex/resources/css/animate.min.css" rel="stylesheet">
<link href="/vertex/resources/css/font-awesome.min.css" rel="stylesheet">
<link href="/vertex/resources/css/form.css" rel="stylesheet">
<link href="/vertex/resources/css/calendar.css" rel="stylesheet">
<link href="/vertex/resources/css/style.css" rel="stylesheet">
<link href="/vertex/resources/css/icons.css" rel="stylesheet">
<link href="/vertex/resources/css/generics.css" rel="stylesheet">
</head>
<body id="skin-blur-ocean">
	<header id="header" class="media">
		<a href="" id="menu-toggle"></a> <a class="logo pull-left"
			href="/vertex/index.html">Vertex Dashboard</a>

		<div class="media-body">
			<div class="media" id="top-menu">
				<div id="time" class="pull-right">
					<span id="hours"></span> : <span id="min"></span> : <span id="sec"></span>
				</div>
			</div>
		</div>
	</header>

	<div class="clearfix"></div>

	<section id="main" class="p-relative" role="main">

		<!-- Sidebar -->
		<aside id="sidebar">

			<!-- Sidbar Widgets -->
			<div class="side-widgets overflow">
				<!-- Profile Menu -->
				<div class="text-center s-widget m-b-25 dropdown" id="profile-menu">
					<a href="" data-toggle="dropdown"> <img
						class="profile-pic animated"
						src="/vertex/resources/img/profile-pics/male-user-icon.jpg" alt="">
					</a>
					<ul class="dropdown-menu profile-menu">
						<li><a href="/vertex/tasks.html">My Tasks</a> <i class="icon left">&#61903;</i><i
							class="icon right">&#61815;</i></li>
						<li><a href="/vertex/logout">Sign Out</a> <i
							class="icon left">&#61903;</i><i class="icon right">&#61815;</i></li>
					</ul>
					<h4 id="userFullName" class="m-0"></h4>
				</div>

				<div class="s-widgets">
					<div class="m-5">
						<a href="#compose-message" data-toggle="modal"
							class="btn btn-sm btn-block">Compose Message</a>
					</div>


					<div class="list-group list-group-flat m-t-15">
						<a class="list-group-item active">Tasks<span id="tasksCount"
							class="badge badge-trp">X</span></a> 
							<a href="#" class="list-group-item">
							<span class="message-tag progress-bar-info"></span>In Progress</a>
							<a href="#" class="list-group-item"><span class="message-tag progress-bar-success"></span>Resolved</a>
							<a href="#" class="list-group-item"><span class="message-tag progress-bar-danger"></span>Blocked</a>
							<a href="#" class="list-group-item"><span class="message-tag progress-bar-warning"></span>Accepted</a>
					</div>

				</div>
			</div>

			<!-- Side Menu -->
			<ul class="list-unstyled side-menu">
				<li class="active"><a class="sa-side-home" href="index.html">
						<span class="menu-item">Dashboard</span>
				</a></li>


			</ul>

		</aside>

		<!-- Content -->
		<section id="content" class="container">

			<h4 class="page-title b-0">My Tasks</h4>

			<div class="message-list list-container">
				<header class="listview-header media">
					<input type="checkbox" class="pull-left list-parent-check" value="">

					<ul class="list-inline pull-right m-t-5 m-b-0">
					</ul>

					<ul class="list-inline list-mass-actions pull-left">
						<li><a href="" title="Refresh" class="tooltips"> <i
								class="sa-list-refresh"></i>
						</a></li>
					</ul>

					<input class="input-sm col-md-4 pull-right message-search"
						type="text" placeholder="Search....">

					<div class="clearfix"></div>
				</header>

				<div id="tasklist"></div>
			</div>

		</section>
	</section>

	<!-- Javascript Libraries -->
	<!-- jQuery -->
	<script src="/vertex/resources/js/jquery.min.js"></script>
	<!-- jQuery Library -->

	<!-- Bootstrap -->
	<script src="/vertex/resources/js/bootstrap.min.js"></script>

	<!--  Form Related -->
	<script src="/vertex/resources/js/icheck.js"></script>
	<!-- Custom Checkbox + Radio -->

	<!-- Text Editor -->
	<script src="/vertex/resources/js/editor.min.js"></script>
	<!-- WYSIWYG Editor -->

	<!-- UX -->
	<script src="/vertex/resources/js/scroll.min.js"></script>
	<!-- Custom Scrollbar -->

	<!-- Other -->
	<script src="/vertex/resources/js/calendar.min.js"></script>
	<!-- Calendar -->
	<script src="/vertex/resources/js/feeds.min.js"></script>
	<!-- News Feeds -->


	<!-- All JS functions -->
	<script src="/vertex/resources/js/functions.js"></script>
	<script src="/vertex/resources/js/template.js"></script>

	<script type="text/javascript">
		$(document).ready(function() {
			getUser();
			getEvents();

			var userEmail = sessionStorage.getItem('userEmail');
			
			$.ajax({
				url : "/vertex/api/task/asignee/" + userEmail,
				type : "GET",
				success : function(jqXHR) {
					$.each(jqXHR, listTask);
					$("#tasksCount").text(jqXHR.length);
				},
				error : function(jqXHR) {
					if (jqXHR.status == 404) {
						var html = '<div class="media"><p class="text-center media-body">You have no tasks yet.</p></div>';
							$('#tasklist').append(html);
							$("#tasksCount").text(0);
					}
				}
			});
		});

		function listTask(index, task) {
			var taskhtml = '<div class="media"><a class="media-body" href="task-details.html?taskId='
					+ task.taskId + '"><div class="pull-left list-title">';
			taskhtml += '<span class="t-overflow">'
			task.creator.fullName + '</span></div>';
			taskhtml += '<div class="pull-right list-date">'
					+ new Date(task.creationTime).toDateString() + '</div>';
			taskhtml += '<div class="media-body hidden-xs"><span class="t-overflow">';
			taskhtml += task.title + '</span></div></a></div>'

			$('#tasklist').append(taskhtml);
		}
	</script>
</body>
</html>

